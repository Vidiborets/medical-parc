{"version":3,"sources":["index.js"],"names":["document","addEventListener","form","getElementById","formAddError","input","parentElement","classList","add","formRemoveError","remove","emailTest","test","value","formsend","e","preventDefault","error","formValidate","formReq","querySelectorAll","index","length","contains","getAttribute","checked","formData","FormData","append","formImage","files","response","fetch","method","body","ok","result","json","alert","message","formPreview","innerHTML","reset","uploadFile","file","includes","type","size","reader","FileReader","onload","target","onerror","readAsDataURL"],"mappings":";AAAA,aAEAA,SAASC,iBAAiB,mBAAmB,WACnCC,MAAAA,EAAOF,SAASG,eAAe,QA0D5BC,SAAAA,EAAaC,GAClBA,EAAMC,cAAcC,UAAUC,IAAI,UAClCH,EAAME,UAAUC,IAAI,UAGfC,SAAAA,EAAgBJ,GACrBA,EAAMC,cAAcC,UAAUG,OAAO,UACrCL,EAAME,UAAUG,OAAO,UAGlBC,SAAAA,EAAUN,GACR,OAAC,gDAAgDO,KAAKP,EAAMQ,OApEvEX,EAAKD,iBAAiB,SAEPa,eAASC,GACpBA,EAAEC,iBAEEC,IAAAA,EA0BCC,SAAahB,GACde,IAAAA,EAAQ,EACRE,EAAUnB,SAASoB,iBAAiB,SAEnC,IAAA,IAAIC,EAAO,EAAGA,EAAQF,EAAQG,OAAQD,IAAS,CAC1ChB,MAAAA,EAAQc,EAAQE,GACtBZ,EAAgBJ,GAEbA,EAAME,UAAUgB,SAAS,UACrBZ,EAAUN,KACTD,EAAaC,GACbY,KAE+B,aAA9BZ,EAAMmB,aAAa,UAA2C,IAAlBnB,EAAMoB,SACvDrB,EAAaC,GACbY,KAEoB,KAAhBZ,EAAMQ,QACNT,EAAaC,GACbY,KAILA,OAAAA,EAjDKC,GAERQ,EAAW,IAAIC,SAASzB,GAGzBe,GAFHS,EAASE,OAAO,QAASC,EAAUC,MAAM,IAE5B,IAAVb,EAAY,CACXf,EAAKK,UAAUC,IAAI,YACfuB,IAAAA,QAAiBC,MAAM,eAAe,CACtCC,OAAO,OACPC,KAAKR,IAENK,GAAAA,EAASI,GAAG,CACPC,IAAAA,QAAeL,EAASM,OAC5BC,MAAMF,EAAOG,SACbC,EAAYC,UAAY,GACxBvC,EAAKwC,QACLxC,EAAKK,UAAUG,OAAO,iBAEtB4B,MAAM,UACNpC,EAAKK,UAAUG,OAAO,iBAG1B4B,MAAM,iCA4CRT,MAAAA,EAAY7B,SAASG,eAAe,aACpCqC,EAAcxC,SAASG,eAAe,eAE5C0B,EAAU5B,iBAAiB,SAAS,MAI3B0C,SAAWC,GACb,IAAC,CAAC,aAAa,YAAY,aAAaC,SAASD,EAAKE,MAGrD,OAFAR,MAAM,qCACNT,EAAUhB,MAAQ,IAInB+B,GAAAA,EAAKG,KAAM,QAEV,YADAT,MAAM,gCAINU,IAAAA,EAAS,IAAIC,WACjBD,EAAOE,OAAS,SAAUnC,GACtByB,EAAYC,uBAAyB1B,EAAEoC,OAAOf,uBAElDY,EAAOI,QAAU,SAASrC,GACtBuB,MAAM,WAEVU,EAAOK,cAAcT,GAtBrBD,CAAWd,EAAUC,MAAM","file":"src.3467494d.js","sourceRoot":"../src","sourcesContent":["\"use strict\"\n\ndocument.addEventListener('DOMContentLoaded',function(){\n    const form = document.getElementById('form')\n    form.addEventListener('submit',formsend);\n\n    async function formsend(e){\n        e.preventDefault()\n\n        let error = formValidate(form)\n\n        let formData = new FormData(form)\n        formData.append('image', formImage.files[0])\n\n        if(error === 0){\n            form.classList.add('_sending')\n            let response = await fetch('sendmail.php',{\n                method:'POST',\n                body:formData\n            })\n            if(response.ok){\n                let result = await response.json()\n                alert(result.message)\n                formPreview.innerHTML = ''\n                form.reset()\n                form.classList.remove('_sending')\n            }else{\n                alert('Ошибка')\n                form.classList.remove('_sending')\n            }\n        }else{\n            alert('Заполните обязательные поля')\n        }\n    }\n\n    function formValidate(form){\n        let error = 0\n        let formReq = document.querySelectorAll('._req')\n\n        for (let index =0; index < formReq.length; index ++){\n            const input = formReq[index];\n            formRemoveError(input)\n\n            if(input.classList.contains('_email')){\n                if(emailTest(input)){\n                    formAddError(input)\n                    error++;\n                }\n            }else if(input.getAttribute(\"type\")=== \"checkbox\" && input.checked === false){\n                formAddError(input)\n                error++\n            }else{\n                if (input.value === ''){\n                    formAddError(input)\n                    error++\n                }\n            }\n        }\n        return error\n    }\n\n    function formAddError(input){\n        input.parentElement.classList.add('_error')\n        input.classList.add('_error')\n    }\n\n    function formRemoveError(input){\n        input.parentElement.classList.remove('_error')\n        input.classList.remove('_error')\n    }\n\n    function emailTest(input){\n        return !/^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,8})+$/.test(input.value)\n    }\n\n    const formImage = document.getElementById('formImage');\n    const formPreview = document.getElementById('formPreview')\n\n    formImage.addEventListener('change',()=>{\n        uploadFile(formImage.files[0])\n    })\n\n    function uploadFile(file){\n        if(!['image/jpeg','image/png','image/gif'].includes(file.type)){\n            alert('Разрешены только изображения')\n            formImage.value = ''\n            return\n        }\n\n        if(file.size >2 * 1024 *1024){\n            alert('Файл должен быть меньше 2 мб')\n            return;\n        }\n\n        var reader = new FileReader()\n        reader.onload = function (e){\n            formPreview.innerHTML = `<img src=\"${e.target.result}\" alt=\"Foto\">`\n        }\n        reader.onerror = function(e){\n            alert('Ошибка')\n        }\n        reader.readAsDataURL(file)\n\n    }\n})"]}